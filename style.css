:root {
  --board-size: min(92vw, 548px);
  --gap: clamp(8px, 2.2vw, 14px);
  --radius: 26px;
  --tile-radius: 14px;
  --tile-size: calc((var(--board-size) - (var(--gap) * 5)) / 4);
  --anim-fast: 140ms;
  --anim-normal: 190ms;
  --font-display: "Bricolage Grotesque", "Segoe UI", sans-serif;
  --font-body: "Chakra Petch", "Segoe UI", sans-serif;
}

* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  min-height: 100%;
}

body {
  display: grid;
  place-items: center;
  padding: clamp(18px, 4vw, 34px);
  font-family: var(--font-body);
  color: var(--text-main);
  background:
    radial-gradient(42% 36% at 14% 8%, var(--bg-glow-1), transparent 72%),
    radial-gradient(44% 40% at 88% 88%, var(--bg-glow-2), transparent 72%),
    repeating-linear-gradient(
      -20deg,
      transparent 0 11px,
      color-mix(in oklab, var(--line-color), transparent) 11px 12px
    ),
    var(--bg-main);
}

.app {
  position: relative;
  width: min(100%, 820px);
  border-radius: 32px;
  padding: clamp(18px, 3vw, 30px);
  background: var(--panel-bg);
  border: 1px solid var(--panel-border);
  box-shadow: var(--panel-shadow);
  overflow: hidden;
  isolation: isolate;
}

.app::before,
.app::after {
  content: "";
  position: absolute;
  pointer-events: none;
  z-index: -1;
}

.app::before {
  inset: 0;
  background: linear-gradient(120deg, transparent 0%, color-mix(in oklab, var(--trim), transparent) 36%, transparent 76%);
}

.app::after {
  width: 260px;
  height: 260px;
  border-radius: 999px;
  right: -130px;
  top: -120px;
  background: radial-gradient(circle, color-mix(in oklab, var(--trim), transparent) 0%, transparent 70%);
}

.hero {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 18px;
  margin-bottom: 16px;
}

.title-block {
  display: grid;
  gap: 4px;
}

.eyebrow {
  margin: 0;
  letter-spacing: 0.11em;
  font-size: 0.72rem;
  text-transform: uppercase;
  color: var(--text-soft);
}

h1 {
  margin: 0;
  font: 800 clamp(2.15rem, 5.4vw, 3.85rem) / 0.9 var(--font-display);
  color: var(--text-main);
  text-transform: uppercase;
  letter-spacing: 0.01em;
  text-shadow: 0 0 18px color-mix(in oklab, var(--trim), transparent);
}

.scoreboard {
  display: flex;
  gap: 10px;
}

.score-card {
  min-width: 116px;
  border-radius: 13px;
  padding: 10px 12px 8px;
  background: var(--score-bg);
  border: 1px solid var(--score-border);
  box-shadow: var(--score-shadow);
  text-align: center;
}

.score-label {
  display: block;
  font-size: 0.7rem;
  text-transform: uppercase;
  color: var(--text-soft);
  letter-spacing: 0.1em;
}

.score-card strong {
  font-size: 1.55rem;
  font-weight: 800;
  color: var(--text-main);
  letter-spacing: 0.02em;
}

.score-card.bump {
  animation: score-pop 300ms ease;
}

.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 18px;
}

.btn {
  border: 1px solid var(--btn-border);
  background: var(--btn-bg);
  color: var(--text-main);
  font: 700 0.9rem/1 var(--font-body);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  padding: 11px 14px;
  border-radius: 12px;
  cursor: pointer;
  transition:
    transform var(--anim-fast) ease,
    box-shadow var(--anim-fast) ease,
    background var(--anim-fast) ease,
    border-color var(--anim-fast) ease;
  box-shadow: var(--btn-shadow);
}

.btn:hover:not(:disabled) {
  transform: translateY(-1px);
  border-color: var(--btn-border-hover);
  box-shadow: var(--btn-shadow-hover);
}

.btn:active:not(:disabled) {
  transform: translateY(1px);
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn-primary {
  background: var(--accent-bg);
  border-color: var(--accent-border);
  color: var(--accent-text);
}

.board-wrap {
  display: grid;
  place-items: center;
  touch-action: none;
}

.board {
  position: relative;
  width: var(--board-size);
  height: var(--board-size);
  padding: var(--gap);
  border-radius: var(--radius);
  background: var(--board-bg);
  border: 1px solid var(--board-border);
  box-shadow: var(--board-shadow);
  overflow: hidden;
}

.board::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  border: 1px solid color-mix(in oklab, var(--trim), transparent);
  pointer-events: none;
}

.grid {
  width: 100%;
  height: 100%;
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-template-rows: repeat(4, 1fr);
  gap: var(--gap);
}

.grid-cell {
  border-radius: var(--tile-radius);
  background: var(--grid-cell-bg);
  border: 1px solid color-mix(in oklab, var(--trim), transparent);
}

.tile-layer,
.fx-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.tile {
  position: absolute;
  width: var(--tile-size);
  height: var(--tile-size);
  display: grid;
  place-items: center;
  border-radius: var(--tile-radius);
  font: 800 clamp(1.1rem, 2.8vw, 2rem) / 1 var(--font-display);
  color: var(--tile-text);
  border: 1px solid color-mix(in oklab, #ffffff 14%, transparent);
  box-shadow: var(--tile-shadow);
  transition: transform var(--anim-normal) cubic-bezier(0.22, 1, 0.36, 1);
}

.tile.small-text {
  font-size: clamp(0.9rem, 2.15vw, 1.45rem);
}

.tile-spawn {
  animation: tile-spawn 220ms cubic-bezier(0.2, 1.03, 0.26, 1);
}

.tile-merge {
  animation: tile-merge 240ms ease;
}

.tile.moving {
  z-index: 9;
  transition: transform var(--anim-normal) cubic-bezier(0.2, 0.98, 0.28, 0.98);
}

.status {
  margin: 16px 0 0;
  padding: 10px 12px;
  border-radius: 12px;
  font-size: 0.9rem;
  letter-spacing: 0.03em;
  color: var(--text-soft);
  border: 1px solid color-mix(in oklab, var(--trim), transparent);
  background: color-mix(in oklab, var(--panel-bg) 82%, #000 18%);
}

.overlay {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  background: color-mix(in oklab, #020304 70%, transparent);
  backdrop-filter: blur(4px);
  padding: 20px;
  z-index: 20;
}

.overlay.hidden {
  display: none;
}

.overlay-card {
  width: min(100%, 440px);
  border-radius: 20px;
  padding: 22px;
  background: var(--panel-bg);
  border: 1px solid var(--panel-border);
  box-shadow: var(--panel-shadow);
}

.overlay-card h2 {
  margin: 0 0 6px;
  font: 800 1.8rem/1 var(--font-display);
  text-transform: uppercase;
}

.overlay-card p {
  margin: 0;
  color: var(--text-soft);
}

.overlay-actions {
  margin-top: 16px;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.theme-neumorph {
  --bg-main: #f8f1e6;
  --bg-glow-1: color-mix(in oklab, #ff8f3c 24%, transparent);
  --bg-glow-2: color-mix(in oklab, #2ec9c5 22%, transparent);
  --line-color: #f6c79b;
  --trim: #ff7f2f;
  --panel-bg: color-mix(in oklab, #fff8ef 91%, #e8ddd0 9%);
  --panel-border: #e9d2b8;
  --panel-shadow: 0 34px 75px -48px #5c31115c;
  --text-main: #3b2b1f;
  --text-soft: #735948;
  --score-bg: #fff2df;
  --score-border: #ebcfab;
  --score-shadow: inset 0 1px 0 #ffffffcc, 0 11px 24px -22px #62340a7d;
  --btn-bg: #ffe8cb;
  --btn-border: #e9c594;
  --btn-border-hover: #d18b52;
  --btn-shadow: 0 10px 22px -20px #6638148f;
  --btn-shadow-hover: 0 12px 26px -18px #5b2f0f8c;
  --accent-bg: #2f2f5e;
  --accent-border: #1f1f40;
  --accent-text: #f4f6ff;
  --board-bg: #f6cfa4;
  --board-border: #d79c63;
  --board-shadow: inset 0 2px 0 #ffffff80, 0 24px 44px -34px #55290590;
  --grid-cell-bg: #e7b67f;
  --tile-text: #2f2218;
  --tile-shadow: 0 12px 20px -14px #6f3a1396;
}

.theme-contrast {
  --bg-main: #0a1016;
  --bg-glow-1: color-mix(in oklab, #26f3f0 30%, transparent);
  --bg-glow-2: color-mix(in oklab, #ff7a2f 28%, transparent);
  --line-color: #123142;
  --trim: #1ed8d0;
  --panel-bg: color-mix(in oklab, #0f1b28 92%, #060c12 8%);
  --panel-border: #255067;
  --panel-shadow: 0 34px 78px -46px #000000cc;
  --text-main: #d8edf7;
  --text-soft: #91adc1;
  --score-bg: #122536;
  --score-border: #2b5c7b;
  --score-shadow: none;
  --btn-bg: #132535;
  --btn-border: #2d5f80;
  --btn-border-hover: #47b8e7;
  --btn-shadow: none;
  --btn-shadow-hover: 0 0 0 1px #47b8e7;
  --accent-bg: #27d7d0;
  --accent-border: #19b8b2;
  --accent-text: #0b1a24;
  --board-bg: #102132;
  --board-border: #2b607f;
  --board-shadow: 0 16px 34px -26px #000000a8;
  --grid-cell-bg: #17334a;
  --tile-text: #0b1925;
  --tile-shadow: 0 12px 20px -14px #000000c7;
}

.value-2 { background: #fef4df; }
.value-4 { background: #ffe7c6; }
.value-8 { background: #ffd89f; }
.value-16 { background: #ffbe7e; }
.value-32 { background: #ff9f70; }
.value-64 { background: #f98363; }
.value-128 { background: #ffd873; }
.value-256 { background: #ffba5c; }
.value-512 { background: #ff9c4e; }
.value-1024 { background: #ff7b46; color: #1c0f09; }
.value-2048 { background: #ff4f44; color: #f8fdff; }
.value-super { background: #f0397b; color: #f8fdff; }

.theme-contrast .value-2 { background: #d0f9ff; }
.theme-contrast .value-4 { background: #9ff4ff; }
.theme-contrast .value-8 { background: #5fe2ff; }
.theme-contrast .value-16 { background: #32c8ff; }
.theme-contrast .value-32 { background: #2ac3e2; }
.theme-contrast .value-64 { background: #1fa8c9; }
.theme-contrast .value-128 { background: #6ef3a7; }
.theme-contrast .value-256 { background: #43e49b; }
.theme-contrast .value-512 { background: #f7da55; }
.theme-contrast .value-1024 { background: #ffb53f; }
.theme-contrast .value-2048 { background: #ff8741; color: #1d1110; }
.theme-contrast .value-super { background: #ff4d74; color: #f8fdff; }

@keyframes tile-spawn {
  from {
    transform: scale(0.56);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes tile-merge {
  0% {
    transform: scale(1);
  }
  45% {
    transform: scale(1.15);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes score-pop {
  0% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-2px);
  }
  100% {
    transform: translateY(0);
  }
}

@media (max-width: 720px) {
  .hero {
    flex-direction: column;
    align-items: flex-start;
  }

  .scoreboard {
    width: 100%;
  }

  .score-card {
    flex: 1;
  }

  .controls .btn {
    flex: 1 1 calc(50% - 5px);
  }
}
